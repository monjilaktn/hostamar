<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <title>Hostamar - Document Upload</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div class="max-w-xl mx-auto mt-10 bg-white p-8 rounded-lg shadow">
        <h1 class="text-2xl font-bold mb-6 text-blue-600">ডকুমেন্ট আপলোড</h1>
        <p class="text-gray-600 mb-6">আপনার ট্রেড লাইসেন্স বা TIN সার্টিফিকেট আপলোড করুন। আমাদের এআই এটি অটোমেটিকালি পড়ে নেবে।</p>
        
        <form id="upload-form" class="space-y-4">
            <div class="border-2 border-dashed border-gray-300 p-10 text-center rounded-lg hover:border-blue-500 cursor-pointer" onclick="document.getElementById('file-input').click()">
                <p id="file-label">ফাইল সিলেক্ট করুন অথবা এখানে ড্র্যাগ করুন</p>
                <input type="file" id="file-input" class="hidden" onchange="updateLabel(this)">
            </div>
            <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 transition">আপলোড করুন</button>
        </form>
        
        <div id="status" class="mt-4 hidden p-4 rounded-lg"></div>
        <div class="mt-6">
            <a href="/dashboard" class="text-blue-600 hover:underline">← ড্যাশবোর্ডে ফিরে যান</a>
        </div>
    </div>

    <script>
        function updateLabel(input) {
            if (input.files.length > 0) {
                document.getElementById('file-label').innerText = "সিলেক্ট করা হয়েছে: " + input.files[0].name;
            }
        }

        document.getElementById('upload-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const token = localStorage.getItem('token');
            if (!token) { alert("দয়া করে আবার লগইন করুন।"); return; }

            const fileInput = document.getElementById('file-input');
            if (fileInput.files.length === 0) { alert("একটি ফাইল সিলেক্ট করুন।"); return; }

            const formData = new FormData();
            formData.append('file', fileInput.files[0]);

            const statusDiv = document.getElementById('status');
            statusDiv.classList.remove('hidden');
            statusDiv.className = "mt-4 p-4 rounded-lg bg-gray-200";
            statusDiv.innerText = "আপলোড হচ্ছে...";

            try {
                const res = await fetch('/upload', {
                    method: 'POST',
                    headers: { 'Authorization': 'Bearer ' + token },
                    body: formData
                });
                const data = await res.json();
                if (data.status === 'success') {
                    statusDiv.className = "mt-4 p-4 rounded-lg bg-green-100 text-green-700";
                    statusDiv.innerText = "সফলভাবে আপলোড হয়েছে! ফাইল: " + data.filename;
                } else {
                    throw new Error("Upload failed");
                }
            } catch (err) {
                statusDiv.className = "mt-4 p-4 rounded-lg bg-red-100 text-red-700";
                statusDiv.innerText = "ভুল হয়েছে: " + err.message;
            }
        });
    </script>
</body>
</html>
